<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Clean Squared Place</title>
  <style>
    :root{
      --cursor-scale: 4.5;
      --board-w: min(1000px, 92vw);
      --board-h: clamp(320px, 56vh, 620px);
      --thick: 1px;
      --accel: 0.12;
      --max-speed: 1.25;
      --change-ms-min: 700;
      --change-ms-max: 1800;
    }

    @font-face{
      font-family: 'NumberOne';
      src: url('/numberone.woff2') format('woff2');
      font-display: swap;
    }
    @font-face {
      font-family: 'Gobold';
      src: url('/Gobold.otf') format('opentype');
      font-weight: normal;
      font-style: normal;
      font-display: swap;
    }

    *{ box-sizing: border-box; }
    html, body{
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #fff;
      color: #111;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      user-select: none !important;
      cursor: none !important;
    }

    .wrap{
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 0;
      margin: 0;
      overflow: hidden;
      position: relative;
    }

    .title {
      position: absolute;
      top: 40px;
      left: 40px;
      font-family: 'Gobold', ui-sans-serif;
      font-size: clamp(36px, 6vmin, 60px);
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
      white-space: nowrap;
      color: #000;
      z-index: 20;
    }

    .hud {
      position: absolute;
      top: 40px;
      right: 40px;
      display: flex;
      justify-content: flex-end;
      align-items: center;
      gap: 10px;
      font-weight: 700;
      z-index: 20;
    }

    .counter{
      position: relative;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 10px;
      border-radius: 8px;
      font-size: 24px;
      background: transparent;
      font-family: 'Gobold', monospace;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }
    .counter .value{ min-width: 2ch; text-align: right; }

    .triangle{
      width: 0; height: 0;
      border-left: 14px solid transparent;
      border-right: 14px solid transparent;
      border-top: 24px solid #000;
    }

    .board{
      position: relative;
      width: var(--board-w);
      height: var(--board-h);
      max-height: 80vh;
      perspective: 1500px;
      margin: 0 auto;
    }

    .playfield{
      position: absolute;
      inset: 0;
      background: transparent;
      clip-path: polygon(6% 75%, 28% 20%, 72% 20%, 94% 75%);
      overflow: hidden;
    }

    .border-3d{
      position: absolute;
      inset: 0;
      pointer-events: none !important;
    }

    .border-3d svg{
      position: absolute;
      width: 100%;
      height: 100%;
    }

    .border-3d polygon{
      fill: none;
      stroke: #000;
      stroke-width: var(--thick);
    }

    .safe-rect{
      position: absolute;
      left: 20%; right: 20%; top: 26%; bottom: 20%;
    }

    .letter{
      position: absolute;
      font-family: 'NumberOne', monospace;
      font-size: clamp(36px, 6vmin, 60px);
      line-height: 1;
      color: #000;
      will-change: transform, opacity;
      transition: opacity 260ms ease, transform 260ms ease;
      cursor: pointer;
      background: transparent;
      border: none;
    }
    .letter.smashed{
      opacity: 0;
      transform: scale(0.5);
      pointer-events: none !important;
    }

    .win{
      position: absolute;
      inset: 0;
      display: grid;
      place-items: center;
      font-family: 'Gobold', ui-sans-serif;
      font-size: clamp(36px, 6vmin, 60px);
      letter-spacing: 0.1em;
      color: #000;
      opacity: 0;
      transition: opacity 400ms ease;
      pointer-events: none;
    }
    .win.show{ opacity: 1; }

    .cursor-hand{
      position: fixed;
      width: 220px;
      aspect-ratio: 480 / 270;
      background: no-repeat center / contain url('../../public/hand.png');
      transform-origin: 1% 35%;
      transform: translate(-6px,-6px) scale(var(--cursor-scale));
      pointer-events: none;
      z-index: 50;
      mix-blend-mode: multiply;
    }

    .letter:focus-visible{ outline: 2px dashed #000; outline-offset: 2px; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="title">Clean SquaredPlace</div>

    <div class="hud">
      <div class="counter" aria-live="polite">
        <span class="value" id="count">0</span>
        <span class="triangle" aria-hidden="true"></span>
      </div>
    </div>

    <div class="board" id="board">
      <div class="playfield" id="playfield">
        <div class="safe-rect" id="safe"></div>
        <div class="win" id="win">ATCG</div>
      </div>
      <div class="border-3d" aria-hidden="true">
        <svg viewBox="0 0 100 100" preserveAspectRatio="none">
          <polygon points="6,75 28,20 72,20 94,75" />
        </svg>
      </div>
    </div>
  </div>

  <div class="cursor-hand" id="cursor" aria-hidden="true"></div>

<script>
// JS original intacto
(function(){
  const letters = Array.from('abcezfgimnuryxvsp');
  const safe = document.getElementById('safe');
  const playfield = document.getElementById('playfield');
  const win = document.getElementById('win');
  const counterEl = document.getElementById('count');
  const cursorEl = document.getElementById('cursor');

  let smashed = 0;
  const actors = [];
  const frag = document.createDocumentFragment();

  letters.forEach(ch => {
    const el = document.createElement('button');
    el.className = 'letter';
    el.textContent = ch;
    el.setAttribute('aria-label', `Letra ${ch}`);
    frag.appendChild(el);

    const angle = Math.random() * Math.PI * 2;
    const speed = 0.5 + Math.random() * 0.8;
    const vx = Math.cos(angle) * speed;
    const vy = Math.sin(angle) * speed;
    const box = safe.getBoundingClientRect();
    const pf = playfield.getBoundingClientRect();
    const x = Math.random() * (box.width - 40) + box.left - pf.left;
    const y = Math.random() * (box.height - 40) + box.top - pf.top;

    actors.push({ el, x, y, vx, vy, alive: true, nextChange: performance.now() + (Math.random() * (1800 - 700) + 700) });
  });
  playfield.appendChild(frag);

  playfield.addEventListener('click', (ev) => {
    const t = ev.target;
    if (t.classList.contains('letter') && !t.classList.contains('smashed')) {
      t.classList.add('smashed');
      smashed++;
      counterEl.textContent = smashed;
      if(smashed >= letters.length){ setTimeout(()=> win.classList.add('show'), 300); }
      cursorEl.style.transform = `translate(0,0) scale(var(--cursor-scale)) rotate(10deg)`;
      setTimeout(()=> { cursorEl.style.transform = `translate(0,0) scale(var(--cursor-scale)) rotate(0deg)`; }, 150);
    }
  });

  window.addEventListener('mousemove', (e)=>{
    cursorEl.style.left = e.clientX + 'px';
    cursorEl.style.top = e.clientY + 'px';
  });

  function loop(ts){
    const dt = Math.min(32, ts - (loop.last || ts));
    loop.last = ts;
    const box = safe.getBoundingClientRect();
    const pf = playfield.getBoundingClientRect();
    const minX = box.left - pf.left, minY = box.top - pf.top;
    const maxX = minX + box.width, maxY = minY + box.height;

    const tms = performance.now();
    for(const a of actors){
      if(!a.alive) continue;
      if(tms >= a.nextChange){
        a.vx += (Math.random()*2-1)*0.12;
        a.vy += (Math.random()*2-1)*0.12;
        const mag = Math.hypot(a.vx,a.vy)||1;
        if(mag>1.25){ a.vx=a.vx/mag*1.25; a.vy=a.vy/mag*1.25; }
        a.nextChange = tms + (Math.random() * (1800 - 700) + 700);
      }
      a.x += a.vx * dt/16.67;
      a.y += a.vy * dt/16.67;
      const w = a.el.offsetWidth || 32, h = a.el.offsetHeight || 32;
      if(a.x<=minX){a.x=minX;a.vx=Math.abs(a.vx);}
      if(a.y<=minY){a.y=minY;a.vy=Math.abs(a.vy);}
      if(a.x+w>=maxX){a.x=maxX-w;a.vx=-Math.abs(a.vx);}
      if(a.y+h>=maxY){a.y=maxY-h;a.vy=-Math.abs(a.vy);}
      a.el.style.transform = `translate(${a.x}px, ${a.y}px)`;
    }
    requestAnimationFrame(loop);
  }
  requestAnimationFrame(loop);
})();
</script>
</body>
</html>
